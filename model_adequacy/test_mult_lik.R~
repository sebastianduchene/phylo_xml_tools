    multlik <- function(al){
	if(class(al) != "DNAbin"){ al <- as.list(as.DNAbin(al)) } else { al <- as.list(al) }
	mat <- as.character(as.list(as.matrix(al))[[1]])
        mat <- mat[, no_gaps]
	for(i in 2:length(as.list(al))){
            mat <- rbind(mat, as.character(as.list(as.matrix(al))[[i]]))
	}

        no_gaps <- which(sapply(1:ncol(mat), function(x) if('-' %in% as.character(mat[,x])){ FALSE}else{TRUE}))
          if(length(no_gaps) >= ncol(mat)) stop('all sites have gaps')


	al <- mat
	nsites <- ncol(al)
	usites <- unique(al, MARGIN = 2)
	liks <- 0
	for(i in 1:ncol(usites)){
            insts <- sum(apply(al, 2, identical, usites[, i]))
#Bollback
            liks <- (log(insts) * insts) + liks
	}
#Bollback
        liks <- liks - (nsites*log(nsites))
	return(liks)
    }

library(ape)

liks <- vector()
for(i in 1:100){
    aln1 <- matrix(sample(c('a', 'c', 'g', 't', '-'), size = 300, replace = T),  3, 100)
    rownames(aln1) <- paste0('A', 1:3)
    aln1 <- as.DNAbin(aln1)
    liks[i] <- multlik(aln1)
}
